<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Freelance Guard - 簡易発注書メーカー | Creators Box</title>
    <meta name="description" content="フリーランス新法対応。フォームに入力するだけで、法的に有効な発注書(PDF)を即座に作成・印刷できます。個人情報保存なし、完全無料。">

    <script>
        // 現在のURLが本番ドメイン(creators-box.net)の場合のみGA4を読み込む
        if (window.location.hostname === "creators-box.net") {
            var script = document.createElement('script');
            script.async = true;
            script.src = "https://www.googletagmanager.com/gtag/js?id=G-WXMCP3D8W6";
            document.head.appendChild(script);

            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-WXMCP3D8W6');
        } else {
            console.log("GA4: ローカル/プレビュー環境のため計測をスキップしました");
        }
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        blue: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                        }
                    },
                    fontFamily: {
                        sans: ['"Inter"', '"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap');

        body {
            font-family: 'Noto Sans JP', sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        /* Print Styles */
        @media print {
            body * {
                visibility: hidden;
            }

            #print-area,
            #print-area * {
                visibility: visible;
            }

            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0;
                padding: 0;
            }

            .no-print {
                display: none !important;
            }

            /* Reset Backgrounds for Print */
            .bg-gray-50 {
                background-color: white !important;
            }

            .shadow-lg {
                box-shadow: none !important;
            }
        }
    </style>

</head>

<body class="bg-gray-50 text-gray-800">
    <div id="app">
        <!-- Header (No Print) -->
        <header class="bg-white shadow-sm no-print">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <a href="../../index.html" class="text-gray-500 hover:text-gray-700 transition">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    <h1 class="text-xl font-bold text-gray-900 tracking-tight">
                        <span class="text-blue-600">Freelance</span> Guard
                    </h1>
                </div>
                <div class="text-xs text-gray-500 hidden sm:block">
                    フリーランス新法対応 発注書作成ツール
                </div>
            </div>
        </header>

        <main class="max-w-4xl mx-auto px-4 py-8 sm:px-6">

            <!-- Tool Card Area (No Print) -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden mb-12 border border-gray-100 no-print">
                <div class="p-6 sm:p-8 bg-gradient-to-r from-blue-50 to-white border-b border-gray-100">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2">発注書を作成</h2>
                    <p class="text-gray-600">
                        フォームに入力するだけで、法的に有効な発注書(PDF)を即座に作成します。<br>
                        <span class="text-xs text-gray-400">※入力データはサーバーに送信されません。</span>
                    </p>
                </div>

                <div class="p-6 sm:p-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column: Basic Info -->
                        <div class="space-y-4">
                            <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2">基本情報</h3>

                            <div>
                                <label class="block text-sm font-medium text-gray-700">発注日</label>
                                <input type="date" v-model="form.orderDate"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700">発注No.</label>
                                <input type="text" v-model="form.orderNumber"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                                    placeholder="例: 20250101-01">
                            </div>

                            <div class="pt-2">
                                <label class="block text-sm font-medium text-gray-700">甲（発注者・支払う側）</label>
                                <input type="text" v-model="form.clientName"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                                    placeholder="会社名・氏名">
                                <input type="text" v-model="form.clientAddress"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 mt-2 text-xs"
                                    placeholder="住所・連絡先">
                            </div>

                            <div class="pt-2">
                                <label class="block text-sm font-medium text-gray-700">乙（受注者・受け取る側）</label>
                                <input type="text" v-model="form.contractorName"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                                    placeholder="屋号・氏名">
                            </div>
                        </div>

                        <!-- Right Column: Details -->
                        <div class="space-y-4">
                            <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-2">取引内容</h3>

                            <div>
                                <label class="block text-sm font-medium text-gray-700">業務内容</label>
                                <textarea v-model="form.description" rows="3"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                                    placeholder="例: Webサイトデザイン制作一式"></textarea>
                            </div>

                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">委託金額(税抜)</label>
                                    <div class="relative mt-1 rounded-md shadow-sm">
                                        <div
                                            class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                                            <span class="text-gray-500 sm:text-sm">¥</span>
                                        </div>
                                        <input type="number" v-model="form.amount"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 pl-7"
                                            placeholder="0">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">消費税率</label>
                                    <select v-model="form.taxRate"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
                                        <option value="0.10">10%</option>
                                        <option value="0.08">8%</option>
                                        <option value="0">0%</option>
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700">納期</label>
                                <input type="date" v-model="form.deliveryDate"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-gray-700">納品場所・方法</label>
                                <input type="text" v-model="form.deliveryPlace"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"
                                    placeholder="例: メール添付にて送付">
                            </div>

                            <div class="bg-blue-50 p-3 rounded-md border border-blue-100">
                                <label class="block text-sm font-bold text-blue-800">支払期日</label>
                                <input type="date" v-model="form.paymentDate"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2 border-blue-200 focus:border-blue-500">

                                <!-- Compliance Alert -->
                                <div v-if="isViolationWait60"
                                    class="mt-2 text-xs text-red-600 bg-red-50 p-2 rounded border border-red-200 flex items-start">
                                    <i class="fas fa-exclamation-triangle mt-0.5 mr-1.5"></i>
                                    <span>
                                        <b>下請法/新法リスク警告:</b><br>
                                        支払期日が納期から60日を超えています。原則として受領から60日以内の支払いが義務付けられています。
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 pt-6 border-t border-gray-100 flex flex-col items-center">
                        <p class="text-xs text-gray-400 mb-4 text-center">
                            「PDFを作成」ボタンを押すと印刷ダイアログが開きます。<br>
                            「PDFに保存」を選択してダウンロードしてください。
                        </p>
                        <button @click="printPDF"
                            class="inline-flex items-center px-8 py-3 border border-transparent text-base font-medium rounded-full shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all transform hover:scale-105">
                            <i class="fas fa-file-pdf mr-2"></i>
                            利用規約に同意してPDFを作成
                        </button>
                    </div>
                </div>
            </div>

            <!-- Content Area (No Print) -->
            <div class="prose prose-blue max-w-none text-gray-600 no-print">
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                        <i class="fas fa-shield-alt text-blue-500 mr-2"></i>
                        フリーランス新法対応。口約束のリスクをゼロに
                    </h2>
                    <p>
                        2024年11月のフリーランス保護新法施行により、たとえ個人間の取引であっても、業務委託時には「直ちに」取引条件を明示することが義務付けられました。
                        SNSのDMや口頭だけの発注は、後々のトラブルの原因になるだけでなく、法律違反となるリスクがあります。
                        Freelance Guardを使えば、必要な項目を埋めるだけで、コンプライアンスに準拠した発注書を瞬時に作成できます。
                    </p>
                </section>

                <div class="grid md:grid-cols-2 gap-8 mb-12">
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">60日ルールの自動チェック</h3>
                        <p class="text-sm">
                            下請法および新法で定められた「支払期日」のルール（給付を受領した日から60日以内）を自動判定します。
                            意図しない法律違反を未然に防ぎ、健全な取引をサポートします。
                        </p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                        <h3 class="text-lg font-bold text-gray-800 mb-3">体制整備義務をクリア</h3>
                        <p class="text-sm">
                            新しい法律で求められる「ハラスメント防止方針」や「育児介護配慮」に関する基本的な条項を発注書に自動的に付記・記載します。
                            個人の発注者では対応が難しい「体制整備」の要件を、ドキュメントレベルでサポートします。
                        </p>
                    </div>
                </div>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800">使い方</h2>
                    <ol class="list-decimal list-inside space-y-2 bg-white p-6 rounded-lg border border-gray-200">
                        <li><span class="font-bold text-gray-700">入力</span>：フォームに必要な取引情報を入力します。</li>
                        <li><span class="font-bold text-gray-700">確認</span>：支払期日が法令遵守しているか、自動チェック機能が作動します。</li>
                        <li><span class="font-bold text-gray-700">発行</span>：「PDFを作成」ボタンを押し、印刷画面からPDFとして保存してください。</li>
                    </ol>
                </section>

                <section>
                    <h2 class="text-2xl font-bold text-gray-800">よくある質問 (FAQ)</h2>
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-lg border border-gray-100">
                            <h4 class="font-bold text-gray-900 mb-1">Q: 個人情報は保存されますか？</h4>
                            <p class="text-sm">A:
                                いいえ。入力されたデータはすべてお使いのブラウザ内でのみ処理され、サーバーには一切送信されません。ページを再読み込みするとデータは消去されます。</p>
                        </div>
                        <div class="bg-white p-4 rounded-lg border border-gray-100">
                            <h4 class="font-bold text-gray-900 mb-1">Q: スマホでも使えますか？</h4>
                            <p class="text-sm">A: はい。スマートフォンからでもPDFとして保存し、そのままChatworkやLINE、Slack等で送信することが可能です。</p>
                        </div>
                    </div>
                </section>
            </div>

        </main>

        <!-- Footer (No Print) -->
        <footer class="bg-white border-t border-gray-200 mt-12 py-8 no-print">
            <div class="max-w-7xl mx-auto px-4 text-center text-gray-500 text-sm">
                <p>&copy; 2025 Creators Box</p>
                <p class="mt-2 text-xs">※本ツールは法的アドバイスを提供するものではありません。個別の契約内容については専門家にご相談ください。</p>
            </div>
        </footer>

        <!-- PRINT AREA: This is hidden by default and shown only during print -->
        <div id="print-area" class="hidden">
            <div class="max-w-[210mm] mx-auto p-12 bg-white text-black leading-relaxed" style="min-height: 297mm;">
                <!-- Print Header -->
                <div class="flex justify-between items-end border-b-2 border-black pb-4 mb-8">
                    <div>
                        <h1 class="text-3xl font-bold">発注書</h1>
                        <p class="text-sm mt-1">発注No: {{ form.orderNumber }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-sm">発行日: {{ formatDate(form.orderDate) }}</p>
                    </div>
                </div>

                <!-- Parties -->
                <div class="flex justify-between mb-8">
                    <div class="w-1/2 pr-4">
                        <p class="text-sm underline mb-1">受注者 (乙)</p>
                        <p class="text-xl font-bold mb-2">{{ form.contractorName }} 様</p>
                    </div>
                    <div class="w-1/2 pl-4 text-right">
                        <p class="text-sm underline mb-1">発注者 (甲)</p>
                        <p class="text-lg font-bold">{{ form.clientName }}</p>
                        <p class="text-sm whitespace-pre-line">{{ form.clientAddress }}</p>
                    </div>
                </div>

                <p class="mb-4">以下の通り発注いたします。</p>

                <!-- Details Table -->
                <table class="w-full mb-8 border-collapse border border-black">
                    <tr>
                        <th class="border border-black bg-gray-100 p-2 text-left w-1/3">業務内容</th>
                        <td class="border border-black p-2 whitespace-pre-line">{{ form.description }}</td>
                    </tr>
                    <tr>
                        <th class="border border-black bg-gray-100 p-2 text-left">納期</th>
                        <td class="border border-black p-2">{{ formatDate(form.deliveryDate) }}</td>
                    </tr>
                    <tr>
                        <th class="border border-black bg-gray-100 p-2 text-left">納品場所・方法</th>
                        <td class="border border-black p-2">{{ form.deliveryPlace }}</td>
                    </tr>
                    <tr>
                        <th class="border border-black bg-gray-100 p-2 text-left">委託金額 (税抜)</th>
                        <td class="border border-black p-2">{{ formatCurrency(form.amount) }}</td>
                    </tr>
                    <tr>
                        <th class="border border-black bg-gray-100 p-2 text-left">消費税 ({{ form.taxRate * 100 }}%)</th>
                        <td class="border border-black p-2">{{ formatCurrency(taxAmount) }}</td>
                    </tr>
                    <tr>
                        <th class="border border-black bg-gray-100 p-2 text-left">合計金額 (税込)</th>
                        <td class="border border-black p-2 font-bold">{{ formatCurrency(totalAmount) }}</td>
                    </tr>
                    <tr>
                        <th class="border border-black bg-gray-100 p-2 text-left">支払期日</th>
                        <td class="border border-black p-2 font-bold">{{ formatDate(form.paymentDate) }}</td>
                    </tr>
                </table>

                <!-- Legal / Compliance Notes -->
                <div class="text-xs border-t border-black pt-4">
                    <h4 class="font-bold mb-1">【遵守事項・体制整備】</h4>
                    <p class="mb-1">1. 本取引は、フリーランス・事業者間取引適正化等法および下請代金支払遅延等防止法を遵守し、給付の受領から60日以内に報酬を支払います。</p>
                    <p class="mb-1">2. 甲は、乙の就業環境を害する言動（ハラスメント行為）を行わない体制を整備し、申出があった場合は適切に対応します。</p>
                    <p class="mb-1">3. 乙から育児・介護等との両立に関する配慮の申出があった場合、甲は業務遂行に支障がない範囲で配慮を行います。</p>
                    <p>4. 契約の解除または更新を行わない場合、甲は原則として30日前までに予告します。</p>
                </div>
            </div>
        </div>

    </div>

    <script>
        const { createApp, reactive, computed } = Vue;

        createApp({
            setup() {
                const today = new Date().toISOString().split('T')[0];

                const form = reactive({
                    orderDate: today,
                    orderNumber: '',
                    clientName: '',
                    clientAddress: '',
                    contractorName: '',
                    description: '',
                    amount: 0,
                    taxRate: '0.10',
                    deliveryDate: '',
                    deliveryPlace: '',
                    paymentDate: ''
                });

                // Computed: Tax Amount
                const taxAmount = computed(() => {
                    return Math.floor(form.amount * parseFloat(form.taxRate || 0));
                });

                // Computed: Total Amount
                const totalAmount = computed(() => {
                    return parseInt(form.amount || 0) + taxAmount.value;
                });

                // Computed: Compliance Violation Check (Payment > Delivery + 60 days)
                const isViolationWait60 = computed(() => {
                    if (!form.deliveryDate || !form.paymentDate) return false;

                    const delivery = new Date(form.deliveryDate);
                    const payment = new Date(form.paymentDate);

                    // Calculate difference in days
                    const diffTime = payment - delivery;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                    return diffDays > 60;
                });

                // Formatters
                const formatCurrency = (val) => {
                    if (!val) return '¥0';
                    return new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(val);
                };

                const formatDate = (dateStr) => {
                    if (!dateStr) return '';
                    const d = new Date(dateStr);
                    return `${d.getFullYear()}年${d.getMonth() + 1}月${d.getDate()}日`;
                };

                // Action
                const printPDF = () => {
                    // GA4 Tracking
                    if (typeof gtag === 'function') {
                        gtag('event', 'use_tool', {
                            'tool_name': document.title.replace(' | Creators Box', '')
                        });
                    }
                    window.print();
                };

                return {
                    form,
                    taxAmount,
                    totalAmount,
                    isViolationWait60,
                    formatCurrency,
                    formatDate,
                    printPDF
                };
            }
        }).mount('#app');
    </script>
</body>

</html>